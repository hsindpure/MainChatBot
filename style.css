 <label for="appId">Qlik Sense App ID:</label>
    <input type="text" id="appId" placeholder="Enter App ID">
    <button id="loadApp">Load App</button>

    <div id="jsonDataContainer">
        <pre id="jsonData"></pre>
    </div>
require(["qlik"], function (qlik) {
    qlik.setOnError(function (error) {
        console.error(error);
    });

    $("#loadApp").click(function() {
        var appId = $("#appId").val();

        if (!appId) {
            alert("Please enter a Qlik Sense App ID.");
            return;
        }

        // Open a Qlik Sense app
        var app = qlik.openApp(appId, {});

        // Get all objects in the app
        app.getObjects(function(objects) {
            var allData = {};

            // Iterate through each object
            var objectPromises = Object.keys(objects).map(function(objectId) {
                return new Promise(function(resolve, reject) {
                    app.getObject(objectId).then(function(object) {
                        object.getLayout().then(function(layout) {
                            allData[objectId] = layout;
                            resolve();
                        }).catch(function(error) {
                            console.error("Error getting layout for object " + objectId + ":", error);
                            allData[objectId] = "Error: " + error.message;
                            resolve(); // Resolve even on error to continue processing other objects
                        });
                    }).catch(function(error) {
                        console.error("Error getting object " + objectId + ":", error);
                        allData[objectId] = "Error: " + error.message;
                        resolve(); // Resolve even on error to continue processing other objects
                    });
                });
            });

            // Wait for all object data to be fetched
            Promise.all(objectPromises).then(function() {
                // Convert the data to JSON
                var jsonData = JSON.stringify(allData, null, 2);

                // Display the JSON in the webpage
                $("#jsonData").text(jsonData);
            }).catch(function(error) {
                console.error("Error processing objects:", error);
                $("#jsonData").text("Error processing objects. Check the console.");
            });
        });
    });
});
